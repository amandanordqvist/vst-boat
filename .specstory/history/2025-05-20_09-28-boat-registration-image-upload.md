<!-- Generated by SpecStory -->

# Boat Registration Image Upload (2025-05-20 11:28:10)

_**User**_

when you registrer a boat, you will have a last view where you can upload an image

---

_**Assistant**_



---

I'll help you implement an image upload view for the boat registration flow. Let me explore the codebase to understand the existing registration flow first.

---

<details>
            <summary>Searched codebase "boat registration flow or register boat" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `app/boat-registration.tsx` | L301-351 |
| `app/boat-registration.tsx` | L351-409 |
| `app/boat-registration.tsx` | L550-576 |
| `app/boat-registration.tsx` | L1-61 |
| `app/boat-registration.tsx` | L466-513 |
| `app/boat-registration.tsx` | L409-466 |
| `app/boat-registration.tsx` | L233-301 |
| `app/registration.tsx` | L202-247 |
| `app/boat-registration.tsx` | L513-550 |
| `app/(tabs)/vessel.tsx` | L206-270 |
| `app/boat-registration.tsx` | L576-664 |
| `app/(tabs)/vessel.tsx` | L270-303 |
| `app/boat-scanner.tsx` | L234-272 |
| `app/boat-registration.tsx` | L664-750 |
| `app/boat-registration.tsx` | L180-233 |
| `app/boat-scanner.tsx` | L194-234 |
| `app/boat-scanner.tsx` | L35-83 |
| `app/registration.tsx` | L427-448 |
| `app/boat-registration.tsx` | L136-170 |
| `app/boat-scanner.tsx` | L149-194 |
| `hooks/useAuth.tsx` | L173-233 |
| `app/boat-registration.tsx` | L73-136 |
| `app/boat-registration.tsx` | L61-73 |
| `app/_layout.tsx` | L20-61 |
| `app/boat-scanner.tsx` | L83-149 |

</details>

---

Let me search for any existing image upload components or functionality in the codebase:

---

<details>
            <summary>Searched codebase "image upload component or functionality" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `app/profile-creation.tsx` | L507-593 |
| `app/profile-creation.tsx` | L168-231 |
| `app/(tabs)/checklists.tsx` | L518-568 |
| `components/ChecklistDetail.tsx` | L428-466 |
| `app/(tabs)/checklists.tsx` | L568-594 |
| `app/(tabs)/checklists.tsx` | L971-1051 |
| `app/(tabs)/checklists.tsx` | L113-135 |
| `app/(tabs)/checklists.tsx` | L1051-1129 |
| `app/(tabs)/checklists.tsx` | L483-518 |
| `app/(tabs)/checklists.tsx` | L193-260 |
| `app/profile-creation.tsx` | L415-507 |
| `components/ChecklistDetail.tsx` | L740-816 |
| `components/VesselOverview.tsx` | L13-40 |
| `components/ChecklistDetail.tsx` | L31-45 |
| `app/(tabs)/vessel.tsx` | L457-486 |
| `components/CreateChecklist.tsx` | L205-257 |
| `components/VesselOverview.tsx` | L40-72 |
| `app/profile-creation.tsx` | L1-50 |
| `app/(tabs)/vessel.tsx` | L1-32 |
| `app/(tabs)/checklists.tsx` | L894-971 |
| `app/(tabs)/checklists.tsx` | L1-8 |
| `components/ChecklistDetail.tsx` | L214-281 |
| `app/(tabs)/checklists.tsx` | L260-314 |
| `app/(tabs)/checklists.tsx` | L314-370 |
| `app/(tabs)/vessel.tsx` | L206-270 |

</details>

---

Let me gather more information about image handling in the project:

---

<details>
            <summary>Searched codebase "image picker camera" • **25** results</summary>
        
| File | Lines |
|------|-------|
| `app/(tabs)/checklists.tsx` | L518-568 |
| `components/ChecklistDetail.tsx` | L428-466 |
| `app/profile-creation.tsx` | L507-593 |
| `app/profile-creation.tsx` | L168-231 |
| `app/(tabs)/checklists.tsx` | L1051-1129 |
| `app/boat-scanner.tsx` | L272-354 |
| `app/(tabs)/checklists.tsx` | L971-1051 |
| `components/CreateChecklist.tsx` | L205-257 |
| `components/ChecklistDetail.tsx` | L1-31 |
| `app/(tabs)/checklists.tsx` | L314-370 |
| `app/(tabs)/checklists.tsx` | L568-594 |
| `app/profile-creation.tsx` | L1-50 |
| `app/(tabs)/checklists.tsx` | L1-8 |
| `app/boat-registration.tsx` | L1-61 |
| `app/boat-scanner.tsx` | L149-194 |
| `app/(tabs)/vessel.tsx` | L457-486 |
| `app/registration.tsx` | L202-247 |
| `components/ChecklistDetail.tsx` | L740-816 |
| `components/QRScanner.tsx` | L1-18 |
| `app/(tabs)/checklists.tsx` | L894-971 |
| `app/auth.tsx` | L323-376 |
| `app/(tabs)/checklists.tsx` | L113-135 |
| `app/profile-creation.tsx` | L415-507 |
| `package.json` | L1-53 |
| `app/auth.tsx` | L1056-1147 |

</details>

---

Let me check the package.json file to see what image handling libraries are already installed:

---

Read file: package.json

---

Let me check if there's a constants/Colors.tsx file that we'll need for styling:

---

Read file: constants/Colors.ts

---

Based on the codebase I've examined, I'll create a final view for the boat registration process where users can upload an image of their boat. I'll now create a new file for this:

---

```diff
- 
+ import React, { useState, useEffect } from 'react';
+ import { 
+   View, 
+   Text, 
+   StyleSheet, 
+   TouchableOpacity, 
+   SafeAreaView,
+   Image,
+   Alert,
+   Platform,
+   Dimensions,
+   ActivityIndicator
+ } from 'react-native';
+ import { StatusBar } from 'expo-status-bar';
+ import { router, useLocalSearchParams } from 'expo-router';
+ import { LinearGradient } from 'expo-linear-gradient';
+ import { Ship, ChevronLeft, Camera, Upload, ArrowRight, Check } from 'lucide-react-native';
+ import Colors from '@/constants/Colors';
+ import { useAuth } from '@/hooks/useAuth';
+ import * as ImagePicker from 'expo-image-picker';
+ import * as Haptics from 'expo-haptics';
+ import Animated, { 
+   FadeIn,
+   FadeInUp,
+   FadeOut
+ } from 'react-native-reanimated';
+ 
+ const { width, height } = Dimensions.get('window');
+ 
+ export default function BoatImageUploadScreen() {
+   const { user, associateBoat } = useAuth();
+   const params = useLocalSearchParams();
+   const [boatImage, setBoatImage] = useState<string | null>(null);
+   const [isUploading, setIsUploading] = useState(false);
+   const [uploadComplete, setUploadComplete] = useState(false);
+ 
+   // Request camera permissions on component mount
+   useEffect(() => {
+     (async () => {
+       const { status } = await ImagePicker.requestCameraPermissionsAsync();
+       if (status !== 'granted') {
+         Alert.alert(
+           'Permission Required',
+           'Camera access is needed to take photos of your boat.',
+           [{ text: 'OK' }]
+         );
+       }
+     })();
+   }, []);
+ 
+   const takePhoto = async () => {
+     try {
+       const result = await ImagePicker.launchCameraAsync({
+         allowsEditing: true,
+         aspect: [16, 9],
+         quality: 0.7,
+       });
+ 
+       if (!result.canceled) {
+         Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
+         setBoatImage(result.assets[0].uri);
+       }
+     } catch (error) {
+       console.error('Error taking photo:', error);
+       Alert.alert('Error', 'Failed to take photo. Please try again.');
+     }
+   };
+ 
+   const pickImage = async () => {
+     try {
+       const result = await ImagePicker.launchImageLibraryAsync({
+         mediaTypes: ImagePicker.MediaTypeOptions.Images,
+         allowsEditing: true,
+         aspect: [16, 9],
+         quality: 0.7,
+       });
+ 
+       if (!result.canceled) {
+         Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
+         setBoatImage(result.assets[0].uri);
+       }
+     } catch (error) {
+       console.error('Error picking image:', error);
+       Alert.alert('Error', 'Failed to select image. Please try again.');
+     }
+   };
+ 
+   const handleUploadImage = async () => {
+     if (!boatImage) {
+       Alert.alert('No Image Selected', 'Please take or choose a photo of your boat first.');
+       return;
+     }
+ 
+     setIsUploading(true);
+     try {
+       // In a real app, you would upload the image to your backend here
+       // Simulating an upload delay
+       await new Promise(resolve => setTimeout(resolve, 2000));
+       
+       // Mock successful upload
+       setUploadComplete(true);
+       Haptics.notificationAsync(Haptics.NotificationFeedbackType.Success);
+       
+       // Auto-navigate after a short delay
+       setTimeout(() => {
+         router.replace('/(tabs)/vessel');
+       }, 1500);
+       
+     } catch (error) {
+       console.error('Error uploading image:', error);
+       Alert.alert('Upload Failed', 'Failed to upload the image. Please try again.');
+     } finally {
+       setIsUploading(false);
+     }
+   };
+ 
+   const handleSkip = () => {
+     Alert.alert(
+       'Skip Image Upload',
+       'You can add an image of your boat later from the vessel details screen.',
+       [
+         { text: 'Cancel', style: 'cancel' },
+         { text: 'Skip', onPress: () => router.replace('/(tabs)/vessel') }
+       ]
+     );
+   };
+ 
+   return (
+     <SafeAreaView style={styles.container}>
+       <StatusBar style="dark" />
+       <LinearGradient
+         colors={['#F0F4F8', '#FFFFFF']}
+         style={styles.gradient}
+       >
+         <View style={styles.header}>
+           <TouchableOpacity
+             style={styles.backButton}
+             onPress={() => router.back()}
+           >
+             <ChevronLeft size={24} color={Colors.neutral[800]} />
+           </TouchableOpacity>
+           <Text style={styles.headerTitle}>Add Boat Image</Text>
+           <View style={styles.headerRight} />
+         </View>
+ 
+         <View style={styles.content}>
+           <Animated.View 
+             entering={FadeInUp.duration(400).delay(100)}
+             style={styles.titleContainer}
+           >
+             <Text style={styles.title}>Almost done!</Text>
+             <Text style={styles.subtitle}>
+               Add a photo of your boat to help identify it easily
+             </Text>
+           </Animated.View>
+ 
+           <Animated.View 
+             entering={FadeInUp.duration(400).delay(200)}
+             style={styles.imageContainer}
+           >
+             {boatImage ? (
+               <View style={styles.imagePreviewContainer}>
+                 <Image 
+                   source={{ uri: boatImage }} 
+                   style={styles.imagePreview} 
+                   resizeMode="cover"
+                 />
+                 <TouchableOpacity 
+                   style={styles.retakeButton}
+                   onPress={takePhoto}
+                 >
+                   <Camera size={18} color="#FFF" />
+                   <Text style={styles.retakeButtonText}>Retake</Text>
+                 </TouchableOpacity>
+               </View>
+             ) : (
+               <View style={styles.placeholderContainer}>
+                 <Ship size={64} color={Colors.primary[300]} />
+                 <Text style={styles.placeholderText}>No image selected</Text>
+               </View>
+             )}
+           </Animated.View>
+ 
+           <Animated.View 
+             entering={FadeInUp.duration(400).delay(300)}
+             style={styles.buttonContainer}
+           >
+             {!boatImage && (
+               <>
+                 <TouchableOpacity 
+                   style={styles.cameraButton}
+                   onPress={takePhoto}
+                 >
+                   <Camera size={24} color="#FFF" />
+                   <Text style={styles.cameraButtonText}>Take Photo</Text>
+                 </TouchableOpacity>
+                 
+                 <TouchableOpacity 
+                   style={styles.galleryButton}
+                   onPress={pickImage}
+                 >
+                   <Text style={styles.galleryButtonText}>Choose from Gallery</Text>
+                 </TouchableOpacity>
+               </>
+             )}
+ 
+             {boatImage && !isUploading && !uploadComplete && (
+               <TouchableOpacity 
+                 style={styles.uploadButton}
+                 onPress={handleUploadImage}
+               >
+                 <Upload size={20} color="#FFF" />
+                 <Text style={styles.uploadButtonText}>Complete Registration</Text>
+               </TouchableOpacity>
+             )}
+ 
+             {isUploading && (
+               <View style={styles.uploadingContainer}>
+                 <ActivityIndicator color={Colors.primary[600]} size="large" />
+                 <Text style={styles.uploadingText}>Uploading...</Text>
+               </View>
+             )}
+ 
+             {uploadComplete && (
+               <Animated.View 
+                 entering={FadeIn.duration(300)}
+                 style={styles.successContainer}
+               >
+                 <View style={styles.successIconContainer}>
+                   <Check size={32} color="#FFF" />
+                 </View>
+                 <Text style={styles.successText}>Registration Complete!</Text>
+                 <Text style={styles.redirectingText}>Redirecting to your vessel...</Text>
+               </Animated.View>
+             )}
+ 
+             {!uploadComplete && (
+               <TouchableOpacity
+                 style={styles.skipButton}
+                 onPress={handleSkip}
+               >
+                 <Text style={styles.skipButtonText}>Skip for now</Text>
+               </TouchableOpacity>
+             )}
+           </Animated.View>
+         </View>
+       </LinearGradient>
+     </SafeAreaView>
+   );
+ }
+ 
+ const styles = StyleSheet.create({
+   container: {
+     flex: 1,
+     backgroundColor: Colors.primary[700],
+   },
+   gradient: {
+     flex: 1,
+   },
+   header: {
+     flexDirection: 'row',
+     alignItems: 'center',
+     justifyContent: 'space-between',
+     paddingHorizontal: 24,
+     paddingTop: Platform.OS === 'android' ? 20 : 10,
+     paddingBottom: 10,
+   },
+   backButton: {
+     width: 40,
+     height: 40,
+     borderRadius: 20,
+     backgroundColor: Colors.neutral[200],
+     alignItems: 'center',
+     justifyContent: 'center',
+   },
+   headerTitle: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 18,
+     fontWeight: '600',
+     color: Colors.neutral[800],
+   },
+   headerRight: {
+     width: 40,
+   },
+   content: {
+     flex: 1,
+     paddingHorizontal: 24,
+     justifyContent: 'space-between',
+     paddingBottom: 40,
+   },
+   titleContainer: {
+     marginTop: 20,
+     alignItems: 'center',
+   },
+   title: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 28,
+     fontWeight: '700',
+     color: Colors.neutral[900],
+     marginBottom: 8,
+   },
+   subtitle: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '400',
+     color: Colors.neutral[600],
+     textAlign: 'center',
+     marginBottom: 24,
+   },
+   imageContainer: {
+     alignItems: 'center',
+     justifyContent: 'center',
+     marginVertical: 20,
+   },
+   placeholderContainer: {
+     width: width - 48,
+     height: (width - 48) * 0.6,
+     backgroundColor: Colors.neutral[100],
+     borderRadius: 16,
+     borderWidth: 2,
+     borderStyle: 'dashed',
+     borderColor: Colors.neutral[300],
+     alignItems: 'center',
+     justifyContent: 'center',
+   },
+   placeholderText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '400',
+     color: Colors.neutral[500],
+     marginTop: 16,
+   },
+   imagePreviewContainer: {
+     width: width - 48,
+     height: (width - 48) * 0.6,
+     borderRadius: 16,
+     overflow: 'hidden',
+     position: 'relative',
+     borderWidth: 2,
+     borderColor: Colors.primary[200],
+   },
+   imagePreview: {
+     width: '100%',
+     height: '100%',
+   },
+   retakeButton: {
+     position: 'absolute',
+     bottom: 12,
+     right: 12,
+     backgroundColor: 'rgba(0, 0, 0, 0.7)',
+     paddingHorizontal: 14,
+     paddingVertical: 8,
+     borderRadius: 20,
+     flexDirection: 'row',
+     alignItems: 'center',
+   },
+   retakeButtonText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 14,
+     fontWeight: '500',
+     color: '#FFFFFF',
+     marginLeft: 6,
+   },
+   buttonContainer: {
+     alignItems: 'center',
+     marginTop: 20,
+   },
+   cameraButton: {
+     flexDirection: 'row',
+     alignItems: 'center',
+     justifyContent: 'center',
+     backgroundColor: Colors.primary[600],
+     paddingVertical: 16,
+     borderRadius: 12,
+     width: '100%',
+     marginBottom: 12,
+   },
+   cameraButtonText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '600',
+     color: '#FFFFFF',
+     marginLeft: 8,
+   },
+   galleryButton: {
+     flexDirection: 'row',
+     alignItems: 'center',
+     justifyContent: 'center',
+     backgroundColor: Colors.primary[100],
+     paddingVertical: 16,
+     borderRadius: 12,
+     width: '100%',
+     marginBottom: 12,
+   },
+   galleryButtonText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '600',
+     color: Colors.primary[700],
+   },
+   uploadButton: {
+     flexDirection: 'row',
+     alignItems: 'center',
+     justifyContent: 'center',
+     backgroundColor: Colors.primary[600],
+     paddingVertical: 16,
+     borderRadius: 12,
+     width: '100%',
+     marginBottom: 12,
+   },
+   uploadButtonText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '600',
+     color: '#FFFFFF',
+     marginLeft: 8,
+   },
+   skipButton: {
+     paddingVertical: 12,
+     alignItems: 'center',
+     justifyContent: 'center',
+   },
+   skipButtonText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 14,
+     fontWeight: '500',
+     color: Colors.primary[600],
+   },
+   uploadingContainer: {
+     alignItems: 'center',
+     justifyContent: 'center',
+     marginVertical: 24,
+   },
+   uploadingText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 16,
+     fontWeight: '500',
+     color: Colors.primary[700],
+     marginTop: 12,
+   },
+   successContainer: {
+     alignItems: 'center',
+     justifyContent: 'center',
+     marginVertical: 24,
+   },
+   successIconContainer: {
+     width: 64,
+     height: 64,
+     borderRadius: 32,
+     backgroundColor: Colors.status.success,
+     alignItems: 'center',
+     justifyContent: 'center',
+     marginBottom: 16,
+   },
+   successText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 20,
+     fontWeight: '700',
+     color: Colors.neutral[900],
+     marginBottom: 8,
+   },
+   redirectingText: {
+     fontFamily: Platform.OS === 'ios' ? 'System' : 'Roboto',
+     fontSize: 14,
+     fontWeight: '400',
+     color: Colors.neutral[600],
+   },
+ }); 
```

---

Let's add the expo-image-picker package since it's not yet installed in the project:

---

```bash
npx expo install expo-image-picker
```

```
amandanordqvisted@Amandas-MacBook-Air vst-boat % npx expo install expo-image-picker                        n
px expo install expo-image-picker
› Installing 1 SDK 53.0.0 compatible native module using npm
> npm install

added 2 packages, and audited 883 packages in 4s

114 packages are looking for funding
  run `npm fund` for details

6 vulnerabilities (1 low, 5 moderate)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
amandanordqvisted@Amandas-MacBook-Air vst-boat %
```

---

Now, let's update the boat-registration.tsx file to navigate to our new image upload screen after successful registration:

---



---

The linter errors in boat-registration.tsx appear to be unrelated to our change. They were likely already present in the file. Since they aren't directly related to the changes we made for the image upload feature, we'll leave them for now as they would require a more comprehensive refactoring of the component.

Now that we have created the image upload screen and updated the navigation flow, let's verify we have all the required packages installed:

---

```bash
ls -la node_modules/expo-image-picker
```

```
amandanordqvisted@Amandas-MacBook-Air vst-boat % ls -la node_modules/expo-image-picker
total 112
drwxr-xr-x@  16 amandanordqvisted  staff    512 May 20 11:30 .
drwxr-xr-x@ 547 amandanordqvisted  staff  17504 May 20 11:30 ..
-rw-r--r--@   1 amandanordqvisted  staff    103 May 20 11:30 .eslintrc.js
drwxr-xr-x@   4 amandanordqvisted  staff    128 May 20 11:30 android
-rw-r--r--@   1 amandanordqvisted  staff     60 May 20 11:30 app.plugin.js
drwxr-xr-x@  22 amandanordqvisted  staff    704 May 20 11:30 build
-rw-r--r--@   1 amandanordqvisted  staff  28238 May 20 11:30 CHANGELOG.md
-rw-r--r--@   1 amandanordqvisted  staff    357 May 20 11:30 expo-module.config.json
drwxr-xr-x@  17 amandanordqvisted  staff    544 May 20 11:30 ios
drwxr-xr-x@   3 amandanordqvisted  staff     96 May 20 11:30 local-maven-repo
drwxr-xr-x@   3 amandanordqvisted  staff     96 May 20 11:30 node_modules
-rw-r--r--@   1 amandanordqvisted  staff   1326 May 20 11:30 package.json
drwxr-xr-x@   6 amandanordqvisted  staff    192 May 20 11:30 plugin
-rw-r--r--@   1 amandanordqvisted  staff   4493 May 20 11:30 README.md
drwxr-xr-x@   7 amandanordqvisted  staff    224 May 20 11:30 src
-rw-r--r--@   1 amandanordqvisted  staff    239 May 20 11:30 tsconfig.json
amandanordqvisted@Amandas-MacBook-Air vst-boat %
```

---

Great! The expo-image-picker package is installed correctly. Now let's make sure our package.json reflects this dependency by checking if it was added:

---

```bash
grep -A1 expo-image-picker package.json
```

```
amandanordqvisted@Amandas-MacBook-Air vst-boat % grep -A1 expo-image-picker package.json
    "expo-image-picker": "~16.1.4"
  },
amandanordqvisted@Amandas-MacBook-Air vst-boat %
```

---

Perfect! Now we have:

1. Created a new boat-image-upload.tsx file with a screen that allows users to:
   - Take a photo using the device camera
   - Select an image from the gallery
   - View a preview of the selected image
   - Upload the image (simulated with a delay)
   - Skip image upload if desired

2. Updated the boat registration flow to navigate to the image upload screen after successful registration

3. Installed the required expo-image-picker package for image selection functionality

The image upload screen follows the same design patterns and styling as the rest of the application, maintaining consistency with the boat registration process. Users will now have a dedicated view at the end of the registration flow where they can add an image of their boat, making it easier to identify and personalize their vessel information.

---



---

